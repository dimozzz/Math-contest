\section{Задача}

Простое число $p > 3$ и целые $a, b$ таковы, что $a^2 + ab + b^2$ делится на $p$. Докажите, что $(a + b)^p - a^p - b^p$ делится на а) $p^2$; б) на $p^3$.

\hrule

\begin{equation*}
FIGNA = (a + b)^p - a^p - b^p = \sum_{k=0}^p{C_p^k a^k b^{p-k}} - a^p - b^p = \sum_{k=1}^{q}{C_p^k (ab)^k(a^{p-2k} + b^{p - 2k})},
\end{equation*}
где $2q + 1 = p$.
\begin{equation*}
a^{p - 2k} + b^{p - 2k} = (ab)^{-(2k - 1)}(a^{p-1}b^{2k - 1} + b^{p-1}a^{2k - 1}) = (ab)^{-(2k-1)}(a^{2k-1} + b^{2k-1}),
\end{equation*}
здесь и далее под равенством понимается сравненимо по модулю $p$.
\begin{multline*}
FIGNA = \sum_{k=1}^q{C_p^k (ab)^k (a^{p-2k} + b^{p-2k})} = \sum_{k=1}^q{C_p^k (ab)^k (ab)^{-(2k-1)}(a^{2k-1} + b^{2k-1})} = \\
= \sum_{k=1}^q{C_p^k (ab)^{-(k-1)}(a^{2k-1} + b^{2k-1})} = \sum_{k=1}^q{C_p^k (ab)^{-(k-1)} f(2k-1)},
\end{multline*}
где $f(k) = a^{k} + b^{k}$.

{\theorem 
$$ f(6k)    = 2(ab)^{3k}        $$
$$ f(6k+1)  = (a+b)(ab)^{3k}    $$
$$ f(6k+2)  = -(ab)^{3k+1}      $$
$$ f(6k+3)  = -2(a+b)(ab)^{3k+1}$$
$$ f(6k+4)  = -(ab)^{3k+2}      $$
$$ f(6k+5)  = (a+b)(ab)^{3k+2}  $$
}
\begin{proof}

{\bfseries База: k = 0.}
Проверяется подстановкой.

{\bfseries Переход. }
\begin{multline*}
    f(k) = a^k + b^k = (a+b)(a^{k-1} + b^{k-1}) - (ab^{k-1} + ba^{k-1}) = (a+b)f(k-1) - (ab)f(k-2).
\end{multline*}
\begin{itemize}
    \item 
        \begin{multline*}
            f(6k) = (a+b)(a+b)(ab)^{3(k-1)+2} - ab(-ab)^{3(k-1)+2} = \\
            = 2(ab)(ab)^{3k-1} = 2(ab)^{3k}.
        \end{multline*}
    \item $f(6k+1) = (a+b) * 2(ab)^{3k} - ab(a+b)ab^{3(k-1)+2} = (a+b)(ab)^{3k}$.
    \item 
        \begin{multline*}
            f(6k+2) = (a+b)(a+b)(ab)^{3k} - (ab)*2(ab)^{3k} = \\
            = (ab)(ab)^{3k} - 2(ab)^{3k+1} = -(ab)^{3k+1}.
        \end{multline*}
    \item $f(6k+3) = (a+b)[-(ab)^{3k+1}] - (ab)(a+b)(ab)^{3k} = -2(a+b)(ab)^{3k+1}$.
    \item 
        \begin{multline*}
            f(6k+4) = (a+b)[-2(a+b)(ab)^{3k+1}] - (ab)[-(ab)^{3k+1}] = \\
            = -2(a+b)^2(ab)^{3k+1} + (ab)^{3k+2} = -(ab)^{3k+2}.
        \end{multline*}
    \item 
        \begin{multline*}
            f(6k+5) = (a+b)[-(ab)^{3k+2}] - (ab)[-2(a+b)(ab)^{3k+1}] = \\
            = (a+b)[-(ab)^{3k+2} + 2(ab)^{3k+2}] = (a+b)(ab)^{3k+2}.
        \end{multline*}        
\end{itemize}
\end{proof}

\begin{multline*}
    FIGNA = \sum_{k=1}^q{C_p^k (ab)^{-(k-1)} f(2k-1)} = \sum_{k=1}^q{C_p^k (ab)^{-(k-1)} (a+b)(ab)^{k-1}s(k)} = \\
    = (a+b) \sum_{k=1}^q{C_p^k}s(k),
\end{multline*}
где $s(k) = -2$, если $k = 3l+2$, иначе $s(k) = 1$.

Пусть $p = 6m + 1$, тогда $q = 3m$, 
\begin{multline*}
    FIGNA = \sum_{k=1}^{3m}{C_p^k} - 3 \sum_{k=1}^{m}{C_p^{3k-1}} = \\
    = 2^{p-1} - 1 - 3 * \frac{(1+1)^p + \rho (1 + \rho)^p + \rho^2 (1 + \rho^2)^p}{2 * 3} =
    - \left[1 + \frac{ \rho(1 + \rho)^{6k+1} + \rho^2 (1 + \rho^2)^{6k + 1}}{2} \right] = \\
    = -\left[1 + \frac{ \rho(1 + \rho) + \rho^2(1 + \rho^2)}{2} \right]
    = -\left[1 + \rho + \rho^2 \right] = 0 \\
\end{multline*}

$$  (1 + \rho)^6 = (1 + 2 \rho + \rho^2)^3 = \rho^3 = 1 $$
$$  (1 + \rho^2)^6 = (1 + 2 \rho^2 + \rho^4)^3 = (\rho^2)^3 = 1 $$

