\section{Задача}

Простое число $p > 3$ и целые $a, b$ таковы, что $a^2 + ab + b^2$ делится на $p$. Докажите, что $(a + b)^p - a^p - b^p$ делится на а) $p^2$; б) на $p^3$.

\hrule

\begin{equation*}
FIGNA = (a + b)^p - a^p - b^p = \sum_{k=0}^p{C_p^k a^k b^{p-k}} - a^p - b^p = \sum_{k=1}^{q}{C_p^k (ab)^k(a^{p-2k} + b^{p - 2k})},
\end{equation*}
где $2q + 1 = p$.
\begin{equation*}
a^{p - 2k} + b^{p - 2k} = (ab)^{-(2k - 1)}(a^{p-1}b^{2k - 1} + b^{p-1}a^{2k - 1}) = (ab)^{-(2k-1)}(a^{2k-1} + b^{2k-1}),
\end{equation*}
здесь и далее под равенством понимается сравненимо по модулю $p$.
\begin{multline*}
FIGNA = \sum_{k=1}^q{C_p^k (ab)^k (a^{p-2k} + b^{p-2k})} = \sum_{k=1}^q{C_p^k (ab)^k (ab)^{-(2k-1)}(a^{2k-1} + b^{2k-1})} = \\
= \sum_{k=1}^q{C_p^k (ab)^{-(k-1)}(a^{2k-1} + b^{2k-1})} = \sum_{k=1}^q{c_p^k (ab)^{-(k-1)} f(2k-1)},
\end{multline*}
где $f(k) = a^{k} + b^{k}$.

{\theorem 
$$ f(6k)    = 2(ab)^{3k}        $$
$$ f(6k+1)  = (a+b)(ab)^{3k}    $$
$$ f(6k+2)  = -(ab)^{3k+1}      $$
$$ f(6k+3)  = -2(a+b)(ab)^{3k+1}$$
$$ f(6k+4)  = -(ab)^{3k+2}      $$
$$ f(6k+5)  = (a+b)^{3k+2}      $$
}
\begin{proof}

{\bfseries База: k = 0.}
Проверяется подстановкой.

{\bfseries Переход. }
\begin{itemize}
    \item $ f(6k) = a^{6k} + b^{6k} = (a^{3k} + b^{3k})^2 - 2(a^{3k}b^{3k}) = (f(3k))^2 - 2(ab)^{3k}. $ Если $k = 2l + 1$, то 
        \begin{multline*}
            (f(3k))^2 = (f(6l+3))^2 = (-2(a+b)(ab)^{3l+1})^2 = 4(a+b)^2(ab)^{6l+2} = \\
            = 4(ab)(ab)^{6l+2} = 4(ab)^{3k},
        \end{multline*}
        иначе $k = 2l$
            $$(f(3k))^2 = (f(6l))^2 = (2(ab)^{3l})^2 = 4(ab)^{3k}.$$ 
        Таким образом $f(6k) = 4(ab)^{3k} - 2(ab)^{3k} = 2(ab)^{3k}$. 
    \item $ f(6k+1) = a^{6k+1} + b^{6k+1} $
\end{itemize}

\end{proof}
